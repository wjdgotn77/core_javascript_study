# 05 클로저
클로저(closure)는 자바스크립트의 개념 중 하나로 execution context(실행컨텍스트)에 대한 사전 지식이 있으면 이해하기 쉬운 개념입니다.
클로저는 자바스크립트 고유의 개념이 아니라 함수를 [일급 객체](https://velog.io/@reveloper-1311/%EC%9D%BC%EA%B8%89-%EA%B0%9D%EC%B2%B4First-Class-Object%EB%9E%80)로 취급하는 함수형 프로그래밍 언어에서 사용되는 중요한 특성입니다.

> 키워드 :: 모듈화, 캡슐화, 스코프
# I. 클로저의 의미 및 원리 이해
## 정의 
### 함수 & 함수가 선언된 어휘적(lexical) 환경의 조합
- 클로저는 함수를 지칭하고, 그 함수가 선언된 환경과의 관계의 개념이 합쳐진것입니다.

### 클로저의 핵심은 스코프를 이용해서, 변수의 접근 범위를 닫는 것입니다.
- 외부함수 스코프에서 내부함수 스코프로 접근 불가능
- 내부함수에서는 외부함수 스코프에서 선언된 변수에 접근 가능
- 내부함수는 외부함수에 선언된 변수에 접근 가능

TODO: 이거 책보고 좀 더 자세하게 적기
```typescript
// 비밀문서는 외부로의 반출을 할 수 없고 비밀좀보자 라는 함수라는 가상의 방에 들어가야 보거나 바꿀 수 있다.
// 비밀문서는 중요한 문서라 권한 없이는 절대로 바뀌면 안된다.
const 비밀좀보자 = (auth) => {
  if(!auth) return '보지마';
  const 비밀문서 = '이거 진짜 짱중요함..';

  return {
    readDoc: () => 비밀문서,
    updateDoc: (추가내용) => 비밀문서 = 비밀문서 + 추가내용;
  }
};

const 비밀몰래보기 = 비밀좀보자(auth);
비밀몰래보기?.read문서();
비밀몰래보기?.update문서('내용 넣을게');
```

### 함수가 호출되는 환경이 아닌, 기존에 선언된 환경을 기준으로 변수를 조회합니다.
- 그래서 외부함수의 실행이 종료된 후에도, 클로저 함수는 외부함수의 스코프 환경에 접근할 수 있습니다.
- 외부 함수 스코프가 내부함수에 의해 언제든 참조될 수 있습니다
- 근데 여기서 클로저 남발하면 퍼포먼스 저하 이슈가 있습니다.

TODO: 클로저의 계층관계를 대한민국 전라남도 순천시에 빗대어 설명해보기
### tl ; dr
> 👉🏻 어떤 함수 A에서 선언한 변수a 를 참조하는 내부함수 B를 외부로 전달할 경우 A의 실행컨텍스트가 종료된 이후에도 변수 a가 사라지지 않는 현상

## 클로저 함수의 장점 (활용편)
### 장점 1 : 데이터 보존
클로저 함수는 외부 함수의 실행이 끝나더라도 외부 함수 내 변수를 사용할 수 있습니다.

이처럼 특정 데이터를 스코프 안에 가두어 둔 채로 계속 사용할 수 있게 하는 패쇄성을 갖습니다.

### 장점 2 : 정보의 접근 제한 (캡슐화)
'[클로저 모듈 패턴](https://medium.com/%EC%98%A4%EB%8A%98%EC%9D%98-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4-%EB%AA%A8%EB%93%88-%ED%8C%A8%ED%84%B4-d5ba2c94eeb5)'을 사용해 객체에 담아 여러 개의 함수를 리턴하도록 만듭니다.

이런한 정보의 접근을 제한하는 것을 캡슐화라고 합니다.

### 장점 3 : 모듈화
클로저 함수를 각각의 변수에 할당하면 각자 독립적으로 값을 사용하고 보존 할 수 있습니다.

함수의 재사용성을 극대화하기 위해 함수 하나를 독립적인 부품의 형태로 분리하는 것을 모듈화라고 하는데 클로저를 통해 데이터와 메소드를 묶어 관리 할 수 있기에 클로저는 모듈화에 유리합니다.
# 그러면 면접때 뭐라고 대답해야 좋을까?

## ⁉️ 클로저란 무엇이고, 클로저를 사용하는 방법과 이유를 이야기해주세요

### 클로저란

함수와 그 함수가 선언된 Lexical 환경의 조합입니다. 

`Lexical scope란`  변수나 함수가 **정의된 곳의 context**를 사용하는 것 입니다. (반대로 Dynamic scope 가 있는데 이는, **변수나 함수가 실행된 곳의 context**를 사용합니다.)

### 사용하는 이유

- Data privacy / closure를 통한 private method 에뮬레이팅
- 보통 우리가 JS 를 module 화 해서 사용하는 module 패턴에서도 사용한다.
- 부분 적용 함수나 함수형 프로그래밍의 커링에서도 사용한다.
